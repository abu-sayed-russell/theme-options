<?php/** * @package  getwebThemeOption */namespace Getweb\Common;class AjaxController {	public function register() {		add_action( 'wp_ajax_getweb_option_save_menu', array( &$this, 'getweb_option_menu_ajax_handler' ) );		add_action( 'wp_ajax_getweb_option_save_field', array( &$this, 'getweb_option_field_ajax_handler' ) );	}	function getweb_option_menu_ajax_handler() {		global $wpdb;		$getParam = isset( $_REQUEST['param'] ) ? $_REQUEST['param'] : '';		if ( ! empty( $getParam ) ) {			if ( $_REQUEST['param'] == "save_menu" ) {				$current_time = date( 'Y-m-d h:i:s a', time() );				$name         = isset( $_REQUEST['name'] ) ? $_REQUEST['name'] : "";				$status       = isset( $_REQUEST['status'] ) ? $_REQUEST['status'] : "";				$extra_class  = isset( $_REQUEST['extra_class'] ) ? $_REQUEST['extra_class'] : "";				$save_menu    = $wpdb->insert( getweb_menu_table(), array(					"name"        => $name,					"status"      => $status,					"extra_class" => $extra_class,					"created_at"  => $current_time,				) );				if ( $save_menu == 1 ) {					echo json_encode( array( "status" => 1, "msg" => "Your data has been successfully saved" ) );				} else {					echo json_encode( array( "status" => 2, "error" => "Something wrong, try again!" ) );				}			} elseif ( $_REQUEST['param'] == "edit_menu" ) {				$current_time = date( 'Y-m-d h:i:s a', time() );				$name         = isset( $_REQUEST['name'] ) ? $_REQUEST['name'] : "";				$status       = isset( $_REQUEST['status'] ) ? $_REQUEST['status'] : "";				$extra_class  = isset( $_REQUEST['extra_class'] ) ? $_REQUEST['extra_class'] : "";				$update_menu  = $wpdb->update( getweb_menu_table(), array(					"name"        => $name,					"status"      => $status,					"extra_class" => $extra_class,					"created_at"  => $current_time,				), array(					"id" => $_REQUEST['edit_menu'],				) );				if ( $update_menu == 1 ) {					echo json_encode( array( "status" => 1, "msg" => "Your data has been successfully updated" ) );				} else {					echo json_encode( array( "status" => 2, "error" => "Something wrong, try again!" ) );				}			} elseif ( $_REQUEST['param'] == "delete_menu" ) {				$delete = $wpdb->delete( getweb_menu_table(), array(					"id" => $_REQUEST['id'],				) );				if ( $delete ) {					$wpdb->delete( getweb_field_table(), array(						"menu_id" => $_REQUEST['id'],					) );				}				echo json_encode( array( "status" => 1, "msg" => "Your data has been successfully deleted" ) );			}		}		wp_die();	}	function getweb_option_field_ajax_handler() {		global $wpdb;		$getParam = isset( $_REQUEST['param'] ) ? $_REQUEST['param'] : '';		if ( ! empty( $getParam ) ) {			if ( $_REQUEST['param'] == "save_field" ) {				$title                = isset( $_REQUEST['title'] ) ? $_REQUEST['title'] : "";				$desc                 = isset( $_REQUEST['description'] ) ? $_REQUEST['description'] : "";				$get_id               = isset( $_REQUEST['get_id'] ) ? $_REQUEST['get_id'] : "";				$default_value        = isset( $_REQUEST['default_value'] ) ? $_REQUEST['default_value'] : "";				$custom_class         = isset( $_REQUEST['custom_class'] ) ? $_REQUEST['custom_class'] : "";				$field_type           = isset( $_REQUEST['field_type'] ) ? $_REQUEST['field_type'] : "";				$menu_id              = isset( $_REQUEST['menu_id'] ) ? $_REQUEST['menu_id'] : "";				$status               = isset( $_REQUEST['status'] ) ? $_REQUEST['status'] : "";				$custom_taxonomy_name = isset( $_REQUEST['custom_taxonomy_name'] ) ? $_REQUEST['custom_taxonomy_name'] : "";				$current_time         = date( 'Y-m-d h:i:s a', time() );				foreach ( $_POST['option_title'] as $key => $value ) {					if (!empty($value)){						$option_value_data[ $key ]['select_title'] = $value;					}else{						$option_value_data = null;					}				}				foreach ( $_POST['option_value'] as $key => $value ) {					if (!empty($value)){						$option_value_data[ $key ]['select_value'] = $value;					}else{						$option_value_data = null;					}				}				$save_field = $wpdb->insert( getweb_field_table(), array(					"title"         => $title,					"description"   => $desc,					"get_id"        => $get_id,					"default_value" => $default_value,					"custom_class"  => $custom_class,					"type"          => $field_type,					"more_values"   => json_encode( $option_value_data ),					"other"         => $custom_taxonomy_name,					"menu_id"       => $menu_id,					"status"        => $status,					"created_at"    => $current_time,				) );				if ( $save_field == 1 ) {					echo json_encode( array( "status" => 1, "msg" => "Your data has been successfully saved" ) );				} else {					echo json_encode( array( "status" => 2, "error" => "Something wrong, try again!" ) );				}			} elseif ( $_REQUEST['param'] == "edit_field" ) {				$title                = isset( $_REQUEST['title'] ) ? $_REQUEST['title'] : "";				$desc                 = isset( $_REQUEST['description'] ) ? $_REQUEST['description'] : "";				$get_id               = isset( $_REQUEST['get_id'] ) ? $_REQUEST['get_id'] : "";				$default_value        = isset( $_REQUEST['default_value'] ) ? $_REQUEST['default_value'] : "";				$custom_class         = isset( $_REQUEST['custom_class'] ) ? $_REQUEST['custom_class'] : "";				$field_type           = isset( $_REQUEST['field_type'] ) ? $_REQUEST['field_type'] : "";				$menu_id              = isset( $_REQUEST['menu_id'] ) ? $_REQUEST['menu_id'] : "";				$status               = isset( $_REQUEST['status'] ) ? $_REQUEST['status'] : "";				$custom_taxonomy_name = isset( $_REQUEST['custom_taxonomy_name'] ) ? $_REQUEST['custom_taxonomy_name'] : "";				$current_time         = date( 'Y-m-d h:i:s a', time() );				foreach ( $_POST['option_title'] as $key => $value ) {					if (!empty($value)){						$option_value_data[ $key ]['select_title'] = $value;					}else{						$option_value_data = null;					}				}				foreach ( $_POST['option_value'] as $key => $value ) {					if (!empty($value)){						$option_value_data[ $key ]['select_value'] = $value;					}else{						$option_value_data = null;					}				}				$update_menu = $wpdb->update( getweb_field_table(), array(					"title"         => $title,					"description"   => $desc,					"get_id"        => $get_id,					"default_value" => $default_value,					"custom_class"  => $custom_class,					"type"          => $field_type,					"more_values"   => json_encode( $option_value_data ),					"other"         => $custom_taxonomy_name,					"menu_id"       => $menu_id,					"status"        => $status,					"created_at"    => $current_time,				), array(					"id" => $_REQUEST['edit_field'],				) );				if ( $update_menu == 1 ) {					echo json_encode( array( "status" => 1, "msg" => "Your data has been successfully updated" ) );				} else {					echo json_encode( array( "status" => 2, "error" => "Something wrong, try again!" ) );				}			} elseif ( $_REQUEST['param'] == "delete_field" ) {				$wpdb->delete( getweb_field_table(), array(					"id" => $_REQUEST['id'],				) );				echo json_encode( array( "status" => 1, "msg" => "Your data has been successfully delete" ) );			}		}		wp_die();	}}